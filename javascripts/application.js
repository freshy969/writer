!function(){window.Elements=function(){function t(){}return t}()}.call(this),function(){window.Helpers=function(){function t(){}return t.get_char_height=function(t){var e,s;return e=document.createElement("div"),e.className="character",e.innerHTML="&nbsp;",t.appendChild(e),s=e.offsetHeight,t.removeChild(e),s},t.get_left_count=function(t,e){var s,i;for(s=0,i=t.children[e-s];i&&"newline"!==i.className;)s+=1,i=t.children[e-s];return s-1},t.get_caret_pos=function(t,e){var s;return s=Array.prototype.slice.call(t.children),s.indexOf(e)},t}.call(this)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};window.Canvas=function(){function e(e){this.el=e,this.paste_listener=t(this.paste_listener,this),this.blur_listener=t(this.blur_listener,this),this.focus_listener=t(this.focus_listener,this),this.keyup_listener=t(this.keyup_listener,this),this.keydown_listener=t(this.keydown_listener,this),this.keypress_listener=t(this.keypress_listener,this),this.el.className=""+this.base_class+" focus",this.el.onpaste=this.paste_listener,this.caret=new Caret(this.el),this.keys={},window.onkeypress=this.keypress_listener,window.onkeydown=this.keydown_listener,window.onkeyup=this.keyup_listener,window.onfocus=this.focus_listener,window.onblur=this.blur_listener}return e.prototype.base_class="canvas transition",e.prototype.keypress_listener=function(t){var e;return 13!==t.which&&32!==t.which?(e=String.fromCharCode(t.which),this.caret.type(e)):void 0},e.prototype.keydown_listener=function(t){switch(this.keys[t.which]=!0,t.which){case 8:this.caret["delete"](t);break;case 9:this.caret.tab(t);break;case 13:this.caret.enter();break;case 32:this.caret.spacebar();break;case 37:this.keys[91]?this.caret.move_all_left(t):this.caret.move_left(t);break;case 38:this.keys[91]?this.caret.move_all_up(t):this.caret.move_up(t);break;case 39:this.keys[91]?this.caret.move_all_right(t):this.caret.move_right(t);break;case 40:this.keys[91]?this.caret.move_all_down(t):this.caret.move_down(t)}return window.getSelection().collapse()},e.prototype.keyup_listener=function(){return this.keys={}},e.prototype.focus_listener=function(){return this.el.className=""+this.base_class+" focus"},e.prototype.blur_listener=function(){return this.el.className=this.base_class},e.prototype.paste_listener=function(t){var e,s,i,r,n;for(s=t.clipboardData.getData("text/plain"),n=[],e=i=0,r=s.length;r>=0?r>i:i>r;e=r>=0?++i:--i)" "===s[e]?n.push(this.caret.spacebar()):"\n"===s[e]?n.push(this.caret.enter()):n.push(this.caret.type(s[e]));return n},e}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};window.Caret=function(){function e(e){this.canvas=e,this.error=t(this.error,this),this.move_all_up=t(this.move_all_up,this),this.move_up=t(this.move_up,this),this.move_all_down=t(this.move_all_down,this),this.move_down=t(this.move_down,this),this.move_all_right=t(this.move_all_right,this),this.move_right=t(this.move_right,this),this.move_all_left=t(this.move_all_left,this),this.move_left=t(this.move_left,this),this["delete"]=t(this["delete"],this),this.enter=t(this.enter,this),this.spacebar=t(this.spacebar,this),this.tab=t(this.tab,this),this.type=t(this.type,this),this.el=document.createElement("div"),this.el.className="caret",this.el.style.height=Helpers.get_char_height(this.canvas)+"px",this.canvas.appendChild(this.el)}return e.prototype.pos=0,e.prototype.tab_size=4,e.prototype.type=function(t){var e;return e=document.createElement("div"),e.className="character",e.innerHTML=t,this.canvas.insertBefore(e,this.el),this.pos+=1},e.prototype.tab=function(t){var e,s,i;for(t.preventDefault(),i=[],e=0,s=this.tab_size;s>=0?s>e:e>s;s>=0?e++:e--)i.push(this.spacebar());return i},e.prototype.spacebar=function(){return this.type("&nbsp;")},e.prototype.enter=function(){var t;return this.pos+=1,t=document.createElement("br"),t.className="newline",this.canvas.insertBefore(t,this.el)},e.prototype["delete"]=function(t){var e,s,i,r,n,a,h,o,l;if(t.preventDefault(),h=window.getSelection(),0===h.toString().length)return e=this.canvas.children[this.pos-1],e?(this.pos-=1,this.canvas.removeChild(e),!0):this.error();for(r=h.getRangeAt(0),n=r.startContainer.parentNode,a=r.endContainer.parentNode,a!==this.canvas&&(this.canvas.insertBefore(this.el,a),this.pos=Helpers.get_caret_pos(this.canvas,this.el),this.move_right()),s=Array.prototype.slice.call(this.canvas.children),i=s.indexOf(n),o=this.pos-i,e=this.canvas.children[this.pos-1],l=0;o>=0?o>l:l>o;o>=0?l++:l--)this.pos-=1,this.canvas.removeChild(e),e=this.canvas.children[this.pos-1];return h.collapse(),!0},e.prototype.move_left=function(t){var e;return t&&t.preventDefault(),this.pos>0?(e=this.canvas.children[this.pos-1],this.pos-=1,this.canvas.insertBefore(this.el,e),!0):this.error()},e.prototype.move_all_left=function(t){var e,s;for(t.preventDefault(),e=Helpers.get_left_count(this.canvas,this.pos),s=0;e>=0?e>s:s>e;e>=0?s++:s--)this.move_left();return this.el.className="caret"},e.prototype.move_right=function(t){var e,s;return t&&t.preventDefault(),this.pos<=this.canvas.children.length-2?(e=this.pos===this.canvas.children.length-2,s=this.canvas.children[this.pos+2],this.pos+=1,e?this.canvas.appendChild(this.el):this.canvas.insertBefore(this.el,s),!0):this.error()},e.prototype.move_all_right=function(t){var e;for(t.preventDefault();;)if(e=this.canvas.children[this.pos+1],e&&"newline"===e.className||!this.move_right())break;return this.el.className="caret"},e.prototype.move_down=function(t){var e,s,i;if(t&&t.preventDefault(),!this.canvas.children[this.pos+1])return this.error();for(e=Helpers.get_left_count(this.canvas,this.pos);this.move_right()&&0!==Helpers.get_left_count(this.canvas,this.pos););for(i=0;e>=0?e>i:i>e;e>=0?i++:i--)s=this.canvas.children[this.pos+1],s&&"newline"===s.className||this.move_right();return this.el.className="caret"},e.prototype.move_all_down=function(t){for(t.preventDefault();;)if(!this.move_right())break;return this.el.className="caret"},e.prototype.move_up=function(t){var e,s,i,r;if(t&&t.preventDefault(),!this.canvas.children[this.pos-1])return this.error();if(e=Helpers.get_left_count(this.canvas,this.pos),e>0)for(;this.move_left()&&0!==Helpers.get_left_count(this.canvas,this.pos););if(this.move_left(),s=Helpers.get_left_count(this.canvas,this.pos),i=s-e,i>0)for(r=0;i>=0?i>r:r>i;i>=0?r++:r--)this.move_left();return this.el.className="caret"},e.prototype.move_all_up=function(t){for(t.preventDefault();;)if(!this.move_left())break;return this.el.className="caret"},e.prototype.error=function(){var t;return this.el.className="caret error",t=this.el,setTimeout(function(){return t.className="caret"},500),!1},e}()}.call(this),function(){var t;t=document.querySelector(".canvas"),t=new Canvas(t)}.call(this),function(){}.call(this);