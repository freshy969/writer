!function(){window.Elements=function(){function t(){}return t}()}.call(this),function(){window.Helpers=function(){function t(){}return t}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};window.Canvas=function(){function e(e){this.el=e,this.paste_listener=t(this.paste_listener,this),this.blur_listener=t(this.blur_listener,this),this.focus_listener=t(this.focus_listener,this),this.keydown_listener=t(this.keydown_listener,this),this.keypress_listener=t(this.keypress_listener,this),this.el.className=""+this.base_class+" focus",this.el.onpaste=this.paste_listener,this.caret=new Caret(this.el),window.onkeypress=this.keypress_listener,window.onkeydown=this.keydown_listener,window.onkeyup=this.keyup_listener,window.onfocus=this.focus_listener,window.onblur=this.blur_listener}return e.prototype.base_class="canvas transition",e.prototype.keypress_listener=function(t){var e;return 13!==t.which&&32!==t.which?(e=String.fromCharCode(t.which),this.caret.type(e)):void 0},e.prototype.keydown_listener=function(t){switch(t.which){case 8:return this.caret["delete"](t);case 9:return this.caret.tab(t);case 13:return this.caret.enter();case 32:return this.caret.spacebar();case 37:return this.caret.move_left();case 38:return this.caret.move_up();case 39:return this.caret.move_right();case 40:return this.caret.move_down()}},e.prototype.focus_listener=function(){return this.el.className=""+this.base_class+" focus"},e.prototype.blur_listener=function(){return this.el.className=this.base_class},e.prototype.paste_listener=function(t){var e,s,i,n,r;for(s=t.clipboardData.getData("text/plain"),r=[],e=i=0,n=s.length;n>=0?n>i:i>n;e=n>=0?++i:--i)" "===s[e]?r.push(this.caret.spacebar()):"\n"===s[e]?r.push(this.caret.enter()):r.push(this.caret.type(s[e]));return r},e}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};window.Caret=function(){function e(e){this.canvas=e,this.get_caret_pos=t(this.get_caret_pos,this),this.get_col_els=t(this.get_col_els,this),this.get_char_height=t(this.get_char_height,this),this.error=t(this.error,this),this.move_up=t(this.move_up,this),this.move_down=t(this.move_down,this),this.move_right=t(this.move_right,this),this.move_left=t(this.move_left,this),this["delete"]=t(this["delete"],this),this.enter=t(this.enter,this),this.spacebar=t(this.spacebar,this),this.tab=t(this.tab,this),this.type=t(this.type,this),this.el=document.createElement("div"),this.el.className="caret",this.el.style.height=this.get_char_height()+"px",this.canvas.appendChild(this.el)}return e.prototype.pos=0,e.prototype.tab_size=4,e.prototype.type=function(t){var e;return window.getSelection().collapse(),e=document.createElement("div"),e.className="character",e.innerHTML=t,this.canvas.insertBefore(e,this.el),this.pos+=1},e.prototype.tab=function(t){var e,s,i,n;for(t.preventDefault(),window.getSelection().collapse(),n=[],e=s=0,i=this.tab_size;i>=0?i>s:s>i;e=i>=0?++s:--s)n.push(this.spacebar());return n},e.prototype.spacebar=function(){return this.type("&nbsp;")},e.prototype.enter=function(){var t;return window.getSelection().collapse(),this.pos+=1,t=document.createElement("br"),t.className="newline",this.canvas.insertBefore(t,this.el)},e.prototype["delete"]=function(t){var e,s,i,n,r,h,o,a,c,l;if(t.preventDefault(),a=window.getSelection(),0===a.toString().length)return e=this.canvas.children[this.pos-1],e?(this.pos-=1,this.canvas.removeChild(e)):this.error();for(r=a.getRangeAt(0),h=r.startContainer.parentNode,o=r.endContainer.parentNode,o!==this.canvas&&(this.canvas.insertBefore(this.el,o),this.pos=this.get_caret_pos(),this.move_right()),s=Array.prototype.slice.call(this.canvas.children),i=s.indexOf(h),c=this.pos-i,e=this.canvas.children[this.pos-1],n=l=1;c>=1?c>=l:l>=c;n=c>=1?++l:--l)this.pos-=1,this.canvas.removeChild(e),e=this.canvas.children[this.pos-1];return a.collapse()},e.prototype.move_left=function(){var t;return window.getSelection().collapse(),this.pos>0?(t=this.canvas.children[this.pos-1],this.pos-=1,this.canvas.insertBefore(this.el,t)):this.error()},e.prototype.move_right=function(){var t,e;return window.getSelection().collapse(),this.pos<=this.canvas.children.length-2?(t=this.pos===this.canvas.children.length-2,e=this.canvas.children[this.pos+2],this.pos+=1,t?this.canvas.appendChild(this.el):this.canvas.insertBefore(this.el,e)):this.error()},e.prototype.move_down=function(){var t,e,s,i;if(window.getSelection().collapse(),s=this.get_col_els(),t=s.indexOf(this.el),s[t+1])if(i=s[t+1],s[t+2]&&(i=s[t+2]),i.offsetTop>this.el.offsetTop+this.el.offsetHeight){for(e=this.pos;"newline"!==this.canvas.children[e].className;)e+=1;this.canvas.insertBefore(this.el,this.canvas.children[e+1])}else i.offsetTop===this.el.offsetTop?this.canvas.appendChild(this.el):this.canvas.insertBefore(this.el,i);else this.pos<this.canvas.children.length-1?this.canvas.appendChild(this.el):this.error();return this.pos=this.get_caret_pos()},e.prototype.move_up=function(){var t,e,s,i;if(window.getSelection().collapse(),s=this.get_col_els(),t=s.indexOf(this.el),s[t-1])if(i=s[t-1],i.offsetTop<this.el.offsetTop-this.el.offsetHeight){for(e=this.pos;"newline"!==this.canvas.children[e].className;)e-=1;this.canvas.insertBefore(this.el,this.canvas.children[e])}else this.canvas.insertBefore(this.el,s[t-1]);else this.pos>0?this.canvas.insertBefore(this.el,this.canvas.children[0]):this.error();return this.pos=this.get_caret_pos()},e.prototype.error=function(){var t;return this.el.className="caret error",t=this.el,setTimeout(function(){return t.className="caret"},500)},e.prototype.get_char_height=function(){var t,e;return t=document.createElement("div"),t.className="character",t.innerHTML="&nbsp;",this.canvas.appendChild(t),e=t.offsetHeight,this.canvas.removeChild(t),e},e.prototype.get_col_els=function(){var t,e,s,i,n,r;for(t=[],e=this.el.offsetLeft,r=this.canvas.children,i=0,n=r.length;n>i;i++)s=r[i],s.offsetLeft===e&&t.push(s);return t},e.prototype.get_caret_pos=function(){var t;return t=Array.prototype.slice.call(this.canvas.children),t.indexOf(this.el)},e}()}.call(this),function(){var t;t=document.querySelector(".canvas"),t=new Canvas(t)}.call(this),function(){}.call(this);