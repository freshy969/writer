(function(){var t,e,s,r,i=function(t,e){return function(){return t.apply(e,arguments)}};t=function(){function t(t){this.el=t,this.keypress_listener=i(this.keypress_listener,this),this.keydown_listener=i(this.keydown_listener,this),this.error=i(this.error,this),this.dec_char_count=i(this.dec_char_count,this),this.inc_char_count=i(this.inc_char_count,this),this.move_right=i(this.move_right,this),this.move_left=i(this.move_left,this),this.el.style.top="50px",this.el.style.left="100px",this.pos=0,this.char_count=0,window.onkeydown=this.keydown_listener,window.onkeypress=this.keypress_listener}return t.prototype.set_canvas=function(t){this.canvas=t},t.prototype.set_char_counter=function(t){this.char_counter=t},t.prototype.move_left=function(t){var e;return e=parseInt(this.el.style.left)-t,this.el.style.left=e+"px",this.pos-=1},t.prototype.move_right=function(t){var e;return e=parseInt(this.el.style.left)+t,this.el.style.left=e+"px",this.pos+=1},t.prototype.inc_char_count=function(){return this.char_count+=1,this.char_counter.innerHTML=this.char_count},t.prototype.dec_char_count=function(){return this.char_count-=1,this.char_counter.innerHTML=this.char_count},t.prototype.error=function(){var t;return this.el.className="cursor error",t=this.el,setTimeout(function(){return t.className="cursor"},500)},t.prototype.keydown_listener=function(t){var e,s,r,i,n;switch(t.which){case 8:return t.preventDefault(),e=this.canvas.children[this.pos-1],e?(this.move_left(e.offsetWidth),this.canvas.removeChild(e),this.dec_char_count()):this.error();case 37:return this.pos>0?(n=this.canvas.children[this.pos-1],this.move_left(n.offsetWidth),this.canvas.removeChild(this.el),this.canvas.insertBefore(this.el,n)):this.error();case 39:if(!(this.pos<=this.canvas.children.length-2))return this.error();if(s=this.pos===this.canvas.children.length-2,r=this.canvas.children[this.pos+1],i=this.canvas.children[this.pos+2],this.move_right(r.offsetWidth),this.canvas.removeChild(this.el),!s(this.canvas.appendChild(this.el)))return this.canvas.insertBefore(this.el,i)}},t.prototype.keypress_listener=function(t){var e;return e=document.createElement("div"),e.className="character",e.innerHTML=String.fromCharCode(t.which),e.innerHTML===" "&&(e.innerHTML="&nbsp;"),this.canvas.insertBefore(e,this.el),this.move_right(e.offsetWidth),this.inc_char_count()},t}(),e=document.querySelector(".canvas"),s=document.querySelector(".char-counter"),r=document.querySelector(".cursor"),r=new t(r),r.set_canvas(e),r.set_char_counter(s)}).call(this);